hi!英雄（机器人测试每组服可支持2.5万人在线，CPU占用75%。）
	――	一款死在侵权上的LOL题材游戏.


责任描述：提供任务,背包,签到,聊天,商店,公会等模块的服务器支持.


运用技术:pomelo框架,node.js,服务器MySQL,前端unity.
pomelo是网易维护的node框架,可配置多进程服务,同时提供进程间通讯的方法(rpc).


项目人员:node5人(其中主程1人,负责整体架构和技术支持,1人负责战斗(c++),1人负责充值,1人负责邮件,剩下模块均某一力承担),unity3人.策划4人,美术若干.

任务:

分为日常,成长,悬赏任务.随角色创建,初始化和存储所有任务,根据等级限制,将任务分为可见和不可见.
监听各个游戏模块事件,记录更新相关任务进度.并向客户端推送消息刷新任务状态.


背包:

分为模板和非模板装备.分别存入不同表.玩家登陆时取出,并推给客户端.
提供增加/消除装备,穿/卸装备的方法.


签到:

签到/补签和签到令.
存储签到月,签到次数,当天是否已签,签到令使用状态.
登陆时根据玩家签到月和当前月比较,以便更新签到月.
签到/补签时,根据当前月1号日期,角色创建日期和当天日期.得出最大签到天数.
最大签到天数减去已签到天数,得出还可签到天数,来决定是否能够签到以及发奖.
签到令:道具使用,获得前5天所有奖励.扣道具,给东西.


聊天(服):

世界聊天:
根据玩家开关聊天界面,聊天服的channel加入和移除玩家信息.
发言时,rpc聊天服,对channel内所有玩家广播聊天内容.
聊天服只缓存20条最近聊天记录.在玩家加入channel时推给客户端.

公会聊天
每个公会维护一个channel,维护自身公会人员上下线的情况.有发言事件时,channel向本公会在线人员广播.

私聊:
直接向被聊人push消息,达到聊天目的.

商店:
根据配置表随意增减商店支持.
现有金币/钻石/竞技场/召唤师峡谷/友情等各大商店.

玩家登陆,根据商店数据层中的商店ID,分别存储从数据库取出的各个商店的商品id和购买状态.推送客户端.
若超过刷新点,删除数据库对应商店数据,插入新刷商品id.购买状态置0.
提供,获得/购买商品的方法.



公会(服):

总服开启时,载入所有公会,公会人员和公会日志.
提供创建/申请/审核/升值/降职/公会设置/查看贡献/查看日志等方法.
更新策略:
1.实时更新:公会服下推前端服更新内容,前端服向client推送更新.如加入,升/降职.
2.dirty更新:当玩家打开公会页面时,rpc公会服取出所有dirty数据,返回client更新.(主要更新模式).


线上测试服:
用pomelo自支持的测试工具,配置服,模拟用户操作.


另外:某也负责user相关模块(非我创建),如:钱包(加/减金币),经验,升级,状态码等.


总结:项目压力很强的项目组,某一人顶多个开发模块.最大的收获是项目完成后,回头俯视(其实是脑部构图)全项目.
并发队列,路由规则,多服支持,进程间通讯,数据缓存,数据批量更新等尽览眼下,虽已无出头之日,却也有一丝满足和喜悦.